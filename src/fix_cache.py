import glob
import json
import gzip
from concurrent.futures import ThreadPoolExecutor
from queue import Queue

import calculate_model_size
from tf_quantization.quantize_model import quantize_model
from tensorflow import keras
import tensorflow as tf

from tf_quantization.transforms.quantize_transforms import PerLayerQuantizeModelTransformer

base_model = keras.models.load_model("mobilenet_tinyimagenet.keras")

cached = [{'quant_conf': [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
           'accuracy': 0.052400000393390656, 'memory': 167266},
          {'quant_conf': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
           'accuracy': 0.28279998898506165, 'memory': 213011},
          {'quant_conf': [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
           'accuracy': 0.4269999861717224, 'memory': 258756},
          {'quant_conf': [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
           'accuracy': 0.462799996137619, 'memory': 304501},
          {'quant_conf': [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
           'accuracy': 0.49380001425743103, 'memory': 350246},
          {'quant_conf': [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7],
           'accuracy': 0.49779999256134033, 'memory': 395991},
          {'quant_conf': [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
           'accuracy': 0.5, 'memory': 441736},
          {'quant_conf': [8, 8, 5, 5, 8, 8, 8, 8, 8, 5, 8, 8, 5, 8, 5, 5, 5, 5, 8, 5, 5, 5, 5, 8, 5, 8, 5, 8],
           'accuracy': 0.4828000068664551, 'memory': 383488},
          {'quant_conf': [8, 4, 5, 4, 5, 5, 4, 5, 4, 4, 5, 5, 4, 5, 5, 4, 4, 5, 5, 4, 5, 5, 5, 4, 5, 4, 4, 5],
           'accuracy': 0.47760000824928284, 'memory': 300085},
          {'quant_conf': [8, 5, 5, 8, 5, 8, 8, 5, 5, 8, 8, 8, 5, 8, 5, 5, 8, 5, 8, 5, 8, 8, 8, 8, 5, 8, 5, 8],
           'accuracy': 0.4715999960899353, 'memory': 374533},
          {'quant_conf': [3, 3, 7, 7, 3, 7, 3, 7, 3, 7, 7, 3, 7, 3, 7, 7, 7, 7, 3, 3, 7, 7, 3, 7, 7, 7, 3, 3],
           'accuracy': 0.2766000032424927, 'memory': 347771},
          {'quant_conf': [2, 8, 2, 8, 2, 2, 8, 2, 8, 2, 2, 8, 8, 8, 2, 8, 2, 2, 2, 2, 2, 8, 2, 8, 2, 2, 8, 2],
           'accuracy': 0.12240000069141388, 'memory': 289594},
          {'quant_conf': [3, 5, 3, 3, 5, 3, 3, 5, 3, 3, 8, 5, 5, 3, 3, 3, 3, 3, 5, 5, 5, 3, 3, 3, 5, 3, 3, 5],
           'accuracy': 0.3075999915599823, 'memory': 261245},
          {'quant_conf': [8, 2, 2, 4, 2, 4, 2, 4, 5, 4, 2, 4, 2, 2, 4, 4, 2, 4, 2, 8, 2, 2, 2, 4, 4, 4, 4, 2],
           'accuracy': 0.1607999950647354, 'memory': 227428},
          {'quant_conf': [7, 8, 7, 7, 7, 2, 7, 2, 2, 2, 7, 7, 7, 7, 7, 7, 7, 2, 2, 7, 2, 2, 2, 7, 2, 7, 2, 2],
           'accuracy': 0.10559999942779541, 'memory': 244056},
          {'quant_conf': [3, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 6, 3, 3, 6, 6, 3, 6, 6, 3, 6, 6, 6, 6, 6, 3, 3, 6],
           'accuracy': 0.3370000123977661, 'memory': 336077},
          {'quant_conf': [2, 2, 6, 2, 2, 6, 8, 6, 6, 6, 2, 2, 6, 6, 2, 2, 2, 6, 2, 6, 6, 8, 6, 2, 6, 2, 2, 2],
           'accuracy': 0.21160000562667847, 'memory': 324814},
          {'quant_conf': [2, 5, 2, 2, 5, 2, 5, 5, 2, 5, 2, 2, 2, 2, 5, 2, 5, 2, 2, 2, 5, 2, 5, 2, 2, 2, 2, 2],
           'accuracy': 0.155799999833107, 'memory': 215560},
          {'quant_conf': [2, 2, 8, 2, 2, 2, 8, 2, 6, 6, 2, 2, 8, 6, 2, 2, 2, 6, 2, 8, 2, 8, 6, 2, 6, 2, 2, 2],
           'accuracy': 0.17659999430179596, 'memory': 273856},
          {'quant_conf': [3, 3, 8, 7, 8, 8, 8, 8, 3, 8, 7, 3, 8, 3, 7, 8, 8, 8, 3, 8, 8, 8, 8, 7, 8, 7, 8, 3],
           'accuracy': 0.4309999942779541, 'memory': 398750},
          {'quant_conf': [3, 8, 6, 8, 6, 8, 6, 8, 3, 8, 8, 8, 8, 3, 8, 6, 3, 8, 6, 8, 6, 6, 6, 8, 8, 3, 8, 8],
           'accuracy': 0.4025999903678894, 'memory': 392888},
          {'quant_conf': [2, 2, 2, 2, 2, 2, 8, 4, 5, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 2, 2, 2, 4, 4, 4, 2, 2],
           'accuracy': 0.12939999997615814, 'memory': 211294},
          {'quant_conf': [8, 2, 2, 6, 2, 6, 2, 6, 5, 6, 8, 4, 6, 2, 6, 4, 2, 6, 6, 8, 2, 2, 6, 6, 6, 4, 6, 6],
           'accuracy': 0.2207999974489212, 'memory': 275596},
          {'quant_conf': [8, 2, 6, 2, 2, 4, 2, 4, 5, 4, 2, 4, 2, 6, 2, 2, 2, 6, 2, 8, 2, 2, 2, 4, 6, 4, 4, 2],
           'accuracy': 0.1306000053882599, 'memory': 248398},
          {'quant_conf': [3, 2, 3, 4, 3, 3, 8, 3, 3, 4, 2, 3, 3, 3, 4, 4, 2, 3, 2, 3, 3, 2, 3, 3, 4, 4, 4, 3],
           'accuracy': 0.2168000042438507, 'memory': 208061},
          {'quant_conf': [7, 7, 7, 7, 5, 5, 5, 5, 5, 5, 8, 5, 7, 5, 5, 5, 5, 5, 5, 7, 7, 5, 7, 7, 7, 7, 7, 5],
           'accuracy': 0.4729999899864197, 'memory': 329145},
          {'quant_conf': [2, 2, 6, 4, 2, 6, 4, 6, 6, 6, 4, 2, 6, 6, 4, 2, 2, 6, 4, 4, 6, 8, 6, 4, 6, 2, 4, 4],
           'accuracy': 0.29679998755455017, 'memory': 330124},
          {'quant_conf': [8, 4, 5, 8, 5, 5, 4, 5, 5, 8, 8, 8, 5, 5, 5, 4, 8, 5, 8, 5, 5, 8, 5, 8, 5, 4, 8, 5],
           'accuracy': 0.4731999933719635, 'memory': 353629},
          {'quant_conf': [8, 7, 6, 7, 7, 7, 7, 6, 6, 6, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 8, 6, 7, 6, 7, 6, 7, 6],
           'accuracy': 0.4893999993801117, 'memory': 370123},
          {'quant_conf': [8, 6, 6, 6, 2, 6, 7, 4, 5, 4, 2, 4, 2, 8, 4, 4, 2, 8, 2, 8, 2, 2, 6, 4, 4, 3, 3, 6],
           'accuracy': 0.2809999883174896, 'memory': 258979},
          {'quant_conf': [3, 3, 5, 3, 3, 3, 3, 3, 3, 3, 3, 5, 5, 3, 3, 3, 3, 3, 3, 5, 3, 3, 3, 3, 5, 3, 3, 5],
           'accuracy': 0.32899999618530273, 'memory': 231677},
          {'quant_conf': [3, 5, 3, 8, 4, 3, 4, 5, 3, 4, 4, 5, 4, 4, 3, 4, 4, 4, 5, 4, 4, 3, 4, 3, 4, 3, 3, 4],
           'accuracy': 0.29600000381469727, 'memory': 256745},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 7, 7, 6, 7, 6, 7, 6, 6, 6, 7, 6, 6, 7, 7, 7, 7, 6, 6, 6, 7, 7, 6],
           'accuracy': 0.5008000135421753, 'memory': 381264},
          {'quant_conf': [2, 5, 8, 8, 4, 3, 5, 5, 3, 4, 2, 2, 2, 4, 5, 4, 5, 4, 5, 4, 5, 3, 5, 2, 4, 2, 3, 4],
           'accuracy': 0.3497999906539917, 'memory': 249829},
          {'quant_conf': [7, 7, 4, 4, 7, 7, 8, 7, 4, 7, 7, 4, 7, 7, 7, 4, 4, 4, 7, 4, 7, 4, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.47699999809265137, 'memory': 347121},
          {'quant_conf': [8, 2, 2, 4, 5, 2, 5, 4, 2, 5, 2, 4, 2, 2, 5, 4, 2, 2, 2, 8, 2, 2, 2, 2, 4, 2, 8, 2],
           'accuracy': 0.12520000338554382, 'memory': 224485},
          {'quant_conf': [7, 2, 7, 7, 2, 7, 4, 7, 6, 6, 4, 2, 6, 6, 6, 7, 6, 6, 7, 7, 6, 8, 6, 4, 6, 7, 7, 4],
           'accuracy': 0.18639999628067017, 'memory': 355272},
          {'quant_conf': [6, 6, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 6, 8, 5, 5, 5, 5, 8, 6, 5, 5, 5, 8, 6, 6, 5, 8],
           'accuracy': 0.4596000015735626, 'memory': 375596},
          {'quant_conf': [8, 3, 5, 3, 3, 8, 3, 3, 8, 5, 3, 3, 5, 3, 8, 5, 5, 3, 3, 5, 5, 5, 3, 3, 5, 3, 3, 3],
           'accuracy': 0.41040000319480896, 'memory': 269140},
          {'quant_conf': [4, 8, 4, 4, 7, 4, 7, 2, 2, 4, 7, 4, 7, 7, 7, 4, 4, 2, 2, 4, 2, 2, 4, 4, 2, 7, 2, 4],
           'accuracy': 0.23680000007152557, 'memory': 227043},
          {'quant_conf': [3, 3, 3, 3, 8, 3, 3, 3, 8, 8, 3, 8, 8, 8, 3, 3, 8, 3, 8, 3, 3, 3, 3, 3, 8, 3, 8, 3],
           'accuracy': 0.3458000123500824, 'memory': 283991},
          {'quant_conf': [3, 3, 3, 3, 5, 5, 3, 3, 3, 3, 3, 5, 3, 3, 3, 4, 3, 3, 3, 3, 5, 5, 5, 3, 3, 4, 4, 8],
           'accuracy': 0.31540000438690186, 'memory': 251798},
          {'quant_conf': [6, 6, 6, 4, 6, 6, 4, 6, 6, 8, 4, 8, 6, 6, 6, 6, 2, 6, 6, 4, 6, 6, 6, 6, 6, 2, 4, 6],
           'accuracy': 0.4189999997615814, 'memory': 352820},
          {'quant_conf': [8, 7, 7, 7, 6, 8, 8, 7, 8, 7, 8, 8, 5, 6, 6, 5, 6, 5, 7, 5, 7, 8, 6, 6, 5, 8, 5, 8],
           'accuracy': 0.49459999799728394, 'memory': 389944},
          {'quant_conf': [7, 7, 2, 7, 6, 4, 7, 7, 5, 8, 6, 7, 6, 6, 4, 7, 2, 4, 7, 7, 2, 2, 6, 4, 6, 4, 4, 2],
           'accuracy': 0.29739999771118164, 'memory': 310227},
          {'quant_conf': [8, 5, 7, 8, 4, 3, 7, 7, 6, 4, 4, 5, 8, 6, 6, 4, 4, 6, 5, 7, 7, 7, 4, 3, 4, 3, 7, 4],
           'accuracy': 0.43160000443458557, 'memory': 336094},
          {'quant_conf': [7, 8, 7, 2, 7, 2, 5, 2, 2, 2, 7, 2, 2, 2, 7, 2, 5, 2, 2, 2, 2, 2, 5, 2, 2, 7, 2, 2],
           'accuracy': 0.07360000163316727, 'memory': 198021},
          {'quant_conf': [8, 4, 5, 5, 4, 4, 4, 4, 4, 5, 4, 4, 5, 4, 4, 5, 5, 4, 8, 4, 5, 4, 4, 4, 8, 4, 5, 4],
           'accuracy': 0.4706000089645386, 'memory': 285853},
          {'quant_conf': [3, 5, 3, 8, 5, 3, 8, 5, 3, 4, 8, 5, 4, 3, 3, 4, 4, 4, 5, 8, 4, 3, 3, 3, 4, 3, 3, 5],
           'accuracy': 0.39980000257492065, 'memory': 260543},
          {'quant_conf': [3, 3, 3, 3, 8, 3, 3, 3, 4, 8, 7, 8, 8, 7, 3, 4, 4, 4, 8, 4, 7, 3, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.4399999976158142, 'memory': 288083},
          {'quant_conf': [8, 4, 4, 4, 5, 5, 8, 5, 4, 4, 5, 5, 4, 7, 5, 4, 4, 4, 7, 4, 7, 4, 7, 4, 8, 4, 4, 7],
           'accuracy': 0.46799999475479126, 'memory': 313357},
          {'quant_conf': [7, 7, 5, 5, 4, 4, 4, 7, 6, 5, 4, 4, 5, 6, 6, 7, 5, 6, 8, 7, 5, 4, 6, 6, 6, 4, 7, 6],
           'accuracy': 0.4772000014781952, 'memory': 327039},
          {'quant_conf': [7, 5, 7, 8, 6, 3, 7, 7, 3, 4, 2, 2, 6, 6, 5, 4, 6, 4, 7, 4, 7, 3, 8, 6, 6, 2, 7, 4],
           'accuracy': 0.42500001192092896, 'memory': 308448},
          {'quant_conf': [3, 7, 3, 7, 8, 3, 3, 7, 8, 8, 6, 8, 6, 8, 3, 7, 8, 6, 7, 7, 8, 7, 3, 6, 8, 3, 7, 6],
           'accuracy': 0.42739999294281006, 'memory': 388031},
          {'quant_conf': [8, 8, 5, 6, 6, 8, 6, 6, 8, 5, 8, 8, 5, 8, 6, 6, 5, 5, 8, 6, 6, 6, 6, 8, 6, 6, 6, 8],
           'accuracy': 0.4966000020503998, 'memory': 375481},
          {'quant_conf': [8, 7, 7, 7, 6, 7, 7, 6, 6, 6, 7, 7, 6, 7, 6, 6, 6, 6, 6, 6, 7, 7, 7, 8, 7, 7, 7, 6],
           'accuracy': 0.4832000136375427, 'memory': 382906},
          {'quant_conf': [2, 2, 2, 8, 4, 4, 2, 4, 5, 4, 2, 4, 2, 4, 5, 4, 2, 4, 2, 4, 8, 3, 2, 4, 4, 8, 4, 4],
           'accuracy': 0.23520000278949738, 'memory': 244777},
          {'quant_conf': [8, 6, 6, 6, 5, 6, 6, 6, 6, 4, 6, 5, 4, 5, 5, 6, 6, 5, 6, 4, 6, 8, 5, 6, 6, 4, 6, 5],
           'accuracy': 0.4821999967098236, 'memory': 360331},
          {'quant_conf': [8, 4, 5, 4, 7, 4, 7, 4, 2, 4, 8, 8, 5, 8, 7, 5, 5, 4, 8, 4, 2, 2, 4, 4, 8, 4, 2, 4],
           'accuracy': 0.3100000023841858, 'memory': 293410},
          {'quant_conf': [3, 6, 3, 6, 8, 6, 3, 3, 6, 8, 3, 6, 8, 8, 6, 6, 8, 6, 6, 6, 3, 3, 3, 6, 6, 3, 8, 6],
           'accuracy': 0.3935999870300293, 'memory': 293156},
          {'quant_conf': [8, 5, 6, 8, 4, 7, 7, 5, 6, 6, 2, 7, 7, 4, 5, 6, 5, 8, 5, 4, 8, 6, 5, 2, 4, 6, 7, 6],
           'accuracy': 0.4553999900817871, 'memory': 312277},
          {'quant_conf': [8, 8, 7, 4, 7, 7, 7, 7, 4, 8, 7, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 4, 7, 4, 8, 4, 7, 7],
           'accuracy': 0.4912000000476837, 'memory': 355618},
          {'quant_conf': [8, 7, 7, 7, 5, 8, 8, 7, 3, 4, 8, 8, 5, 6, 6, 4, 6, 5, 8, 8, 7, 8, 6, 6, 4, 3, 5, 5],
           'accuracy': 0.4763999879360199, 'memory': 382207},
          {'quant_conf': [8, 2, 2, 4, 7, 7, 2, 7, 5, 4, 7, 4, 7, 2, 7, 4, 2, 4, 7, 4, 8, 8, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.33399999141693115, 'memory': 367468},
          {'quant_conf': [8, 7, 4, 4, 5, 7, 4, 5, 4, 7, 5, 5, 4, 7, 7, 4, 4, 4, 7, 4, 8, 5, 7, 4, 8, 4, 4, 5],
           'accuracy': 0.4691999852657318, 'memory': 334042},
          {'quant_conf': [7, 8, 5, 6, 6, 8, 7, 7, 8, 5, 8, 8, 5, 6, 4, 6, 2, 4, 7, 7, 6, 8, 6, 8, 6, 6, 6, 8],
           'accuracy': 0.47999998927116394, 'memory': 399558},
          {'quant_conf': [7, 8, 7, 4, 8, 7, 8, 7, 4, 8, 7, 4, 7, 7, 7, 7, 7, 4, 7, 4, 7, 4, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.48539999127388, 'memory': 354300},
          {'quant_conf': [7, 7, 5, 5, 7, 4, 4, 7, 7, 7, 4, 7, 7, 6, 7, 7, 7, 6, 7, 7, 5, 4, 6, 7, 7, 4, 7, 4],
           'accuracy': 0.47679999470710754, 'memory': 351396},
          {'quant_conf': [8, 4, 5, 4, 8, 4, 7, 2, 2, 4, 7, 4, 7, 7, 7, 4, 5, 4, 8, 4, 2, 2, 4, 4, 8, 7, 2, 4],
           'accuracy': 0.3352000117301941, 'memory': 262027},
          {'quant_conf': [8, 4, 5, 4, 7, 8, 7, 6, 8, 5, 8, 8, 5, 8, 6, 6, 5, 5, 8, 4, 6, 2, 6, 4, 8, 6, 6, 4],
           'accuracy': 0.4302000105381012, 'memory': 329842},
          {'quant_conf': [7, 5, 3, 7, 7, 7, 7, 7, 3, 7, 8, 7, 4, 7, 3, 7, 4, 7, 7, 8, 7, 3, 3, 3, 7, 3, 3, 5],
           'accuracy': 0.4415999948978424, 'memory': 335439},
          {'quant_conf': [8, 8, 5, 8, 8, 8, 6, 6, 8, 6, 8, 8, 8, 8, 6, 6, 5, 5, 8, 6, 5, 8, 5, 8, 5, 8, 6, 8],
           'accuracy': 0.4851999878883362, 'memory': 395800},
          {'quant_conf': [7, 7, 7, 7, 6, 4, 7, 4, 2, 4, 6, 8, 5, 8, 7, 5, 6, 4, 8, 4, 2, 2, 8, 4, 8, 4, 2, 6],
           'accuracy': 0.33320000767707825, 'memory': 297429},
          {'quant_conf': [7, 4, 4, 8, 7, 7, 8, 7, 2, 4, 7, 4, 5, 7, 7, 4, 5, 4, 7, 4, 7, 4, 4, 4, 8, 4, 8, 7],
           'accuracy': 0.47360000014305115, 'memory': 341184},
          {'quant_conf': [7, 7, 5, 8, 8, 4, 8, 7, 8, 8, 8, 8, 5, 6, 8, 7, 8, 8, 8, 8, 8, 8, 6, 6, 8, 8, 8, 8],
           'accuracy': 0.49459999799728394, 'memory': 405654},
          {'quant_conf': [8, 8, 8, 8, 8, 4, 8, 2, 2, 8, 8, 4, 8, 8, 7, 8, 4, 2, 2, 8, 8, 2, 8, 4, 8, 8, 2, 4],
           'accuracy': 0.25360000133514404, 'memory': 279619},
          {'quant_conf': [4, 4, 5, 4, 7, 4, 7, 4, 2, 4, 7, 4, 7, 8, 7, 5, 4, 2, 8, 4, 2, 2, 4, 8, 2, 7, 2, 4],
           'accuracy': 0.27379998564720154, 'memory': 259428},
          {'quant_conf': [8, 8, 7, 7, 6, 7, 7, 7, 4, 7, 6, 4, 7, 7, 7, 7, 7, 6, 7, 7, 7, 7, 7, 6, 8, 4, 7, 6],
           'accuracy': 0.4880000054836273, 'memory': 388702},
          {'quant_conf': [8, 4, 5, 6, 6, 8, 6, 6, 2, 4, 8, 8, 5, 8, 7, 8, 5, 5, 8, 4, 5, 6, 4, 8, 8, 4, 2, 8],
           'accuracy': 0.43380001187324524, 'memory': 376708},
          {'quant_conf': [8, 7, 5, 7, 8, 8, 8, 7, 8, 7, 8, 8, 5, 6, 6, 5, 5, 8, 8, 5, 5, 5, 5, 6, 5, 8, 5, 8],
           'accuracy': 0.48080000281333923, 'memory': 363277},
          {'quant_conf': [8, 8, 7, 5, 6, 8, 8, 8, 8, 5, 8, 8, 5, 6, 6, 5, 5, 5, 7, 5, 5, 8, 6, 8, 5, 8, 5, 8],
           'accuracy': 0.4941999912261963, 'memory': 405061},
          {'quant_conf': [6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 7, 7, 8, 6, 6, 6, 6, 6, 7, 6],
           'accuracy': 0.49059998989105225, 'memory': 358337},
          {'quant_conf': [3, 8, 7, 4, 8, 3, 8, 3, 4, 8, 7, 4, 7, 7, 7, 4, 4, 4, 7, 4, 7, 3, 7, 8, 8, 4, 8, 7],
           'accuracy': 0.38920000195503235, 'memory': 298283},
          {'quant_conf': [8, 7, 7, 7, 6, 8, 7, 7, 8, 7, 6, 4, 7, 7, 7, 7, 6, 5, 7, 5, 7, 7, 7, 6, 8, 4, 7, 6],
           'accuracy': 0.492000013589859, 'memory': 389059},
          {'quant_conf': [8, 7, 5, 4, 6, 8, 7, 7, 8, 8, 8, 4, 5, 6, 7, 8, 6, 5, 8, 5, 2, 8, 4, 6, 8, 8, 2, 8],
           'accuracy': 0.25780001282691956, 'memory': 392914},
          {'quant_conf': [8, 3, 7, 3, 6, 3, 3, 7, 4, 7, 7, 8, 8, 6, 3, 4, 6, 4, 7, 4, 7, 8, 6, 4, 5, 4, 5, 7],
           'accuracy': 0.4625999927520752, 'memory': 361243},
          {'quant_conf': [8, 7, 5, 4, 7, 7, 4, 7, 6, 8, 4, 4, 5, 7, 6, 7, 7, 7, 7, 7, 7, 4, 7, 4, 6, 4, 7, 6],
           'accuracy': 0.46219998598098755, 'memory': 342559},
          {'quant_conf': [7, 8, 7, 4, 6, 7, 7, 7, 4, 8, 7, 7, 7, 7, 7, 7, 7, 6, 7, 7, 7, 7, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.4781999886035919, 'memory': 390597},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 7, 7, 4, 7, 6, 8, 7, 8, 7, 5, 7, 4, 7, 7, 7, 7, 8, 4, 8, 4, 2, 6],
           'accuracy': 0.444599986076355, 'memory': 393561},
          {'quant_conf': [7, 7, 8, 7, 7, 7, 7, 8, 2, 7, 6, 8, 5, 8, 7, 7, 6, 4, 7, 4, 2, 7, 8, 4, 8, 7, 7, 7],
           'accuracy': 0.47279998660087585, 'memory': 402420},
          {'quant_conf': [8, 7, 5, 7, 6, 8, 6, 6, 8, 5, 6, 7, 6, 6, 6, 8, 6, 5, 7, 6, 7, 6, 8, 8, 6, 6, 8, 8],
           'accuracy': 0.492000013589859, 'memory': 368581},
          {'quant_conf': [8, 8, 7, 4, 6, 7, 8, 7, 4, 8, 8, 4, 7, 7, 7, 7, 7, 6, 7, 4, 7, 7, 7, 6, 8, 4, 7, 6],
           'accuracy': 0.4880000054836273, 'memory': 385885},
          {'quant_conf': [6, 6, 6, 7, 6, 6, 6, 6, 6, 7, 7, 8, 6, 7, 7, 7, 7, 6, 6, 6, 7, 7, 6, 6, 7, 7, 6, 7],
           'accuracy': 0.49059998989105225, 'memory': 375458},
          {'quant_conf': [6, 6, 5, 5, 8, 4, 4, 7, 6, 6, 4, 6, 5, 6, 6, 8, 6, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 6],
           'accuracy': 0.492000013589859, 'memory': 361559},
          {'quant_conf': [8, 4, 7, 4, 8, 7, 7, 7, 2, 4, 7, 4, 7, 7, 7, 8, 8, 4, 8, 7, 2, 7, 7, 4, 7, 7, 2, 7],
           'accuracy': 0.18639999628067017, 'memory': 375100},
          {'quant_conf': [7, 8, 7, 7, 8, 7, 7, 7, 4, 7, 8, 4, 7, 7, 7, 7, 7, 7, 7, 8, 7, 4, 5, 4, 7, 4, 7, 7],
           'accuracy': 0.4535999894142151, 'memory': 352617},
          {'quant_conf': [7, 5, 7, 7, 6, 7, 7, 7, 3, 4, 6, 4, 6, 7, 7, 4, 6, 6, 7, 7, 7, 7, 8, 6, 8, 2, 7, 4],
           'accuracy': 0.4564000070095062, 'memory': 381909},
          {'quant_conf': [7, 8, 7, 8, 6, 3, 7, 4, 2, 4, 2, 2, 6, 6, 5, 4, 6, 4, 8, 4, 2, 3, 8, 4, 8, 2, 7, 6],
           'accuracy': 0.3686000108718872, 'memory': 284289},
          {'quant_conf': [7, 6, 7, 7, 7, 7, 7, 7, 6, 6, 8, 7, 7, 7, 6, 6, 7, 7, 8, 6, 6, 6, 6, 7, 6, 7, 7, 7],
           'accuracy': 0.490200012922287, 'memory': 376512},
          {'quant_conf': [8, 8, 7, 8, 8, 3, 7, 7, 3, 8, 8, 2, 8, 8, 8, 8, 6, 8, 8, 8, 8, 8, 8, 6, 8, 8, 7, 4],
           'accuracy': 0.4228000044822693, 'memory': 394885},
          {'quant_conf': [7, 8, 7, 7, 7, 7, 8, 7, 7, 8, 7, 4, 7, 7, 7, 7, 7, 7, 7, 4, 8, 7, 7, 7, 7, 8, 7, 7],
           'accuracy': 0.4936000108718872, 'memory': 387555},
          {'quant_conf': [8, 6, 5, 4, 6, 8, 7, 6, 8, 6, 6, 6, 5, 8, 8, 6, 6, 8, 6, 6, 6, 2, 6, 4, 6, 6, 6, 4],
           'accuracy': 0.47600001096725464, 'memory': 316993},
          {'quant_conf': [8, 8, 7, 7, 8, 8, 8, 7, 8, 8, 8, 8, 8, 8, 6, 5, 8, 5, 8, 8, 7, 8, 8, 8, 8, 8, 5, 8],
           'accuracy': 0.4973999857902527, 'memory': 427219},
          {'quant_conf': [8, 7, 7, 7, 7, 8, 7, 6, 8, 5, 8, 4, 5, 8, 6, 7, 6, 5, 7, 4, 6, 2, 6, 4, 8, 4, 6, 6],
           'accuracy': 0.41940000653266907, 'memory': 324775},
          {'quant_conf': [8, 7, 7, 7, 6, 8, 7, 7, 8, 7, 6, 4, 5, 7, 7, 7, 8, 5, 7, 5, 7, 8, 7, 6, 8, 4, 7, 6],
           'accuracy': 0.4950000047683716, 'memory': 399331},
          {'quant_conf': [7, 4, 7, 7, 7, 8, 7, 6, 8, 5, 8, 8, 6, 6, 6, 6, 6, 5, 7, 8, 6, 7, 6, 6, 8, 7, 7, 6],
           'accuracy': 0.49540001153945923, 'memory': 385203},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 8, 8, 7, 7, 8, 8, 5, 7, 6, 7, 7, 8, 7, 7, 7, 8, 6, 6, 7, 7, 7, 8],
           'accuracy': 0.49900001287460327, 'memory': 413364},
          {'quant_conf': [6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 6, 4, 6, 6, 7, 7, 8, 7, 7, 6, 7, 6, 7, 4, 6, 4, 6, 6],
           'accuracy': 0.48660001158714294, 'memory': 342578},
          {'quant_conf': [7, 5, 7, 8, 6, 8, 6, 6, 3, 6, 2, 6, 6, 6, 5, 4, 6, 6, 6, 6, 7, 3, 6, 6, 6, 6, 7, 6],
           'accuracy': 0.4607999920845032, 'memory': 323082},
          {'quant_conf': [8, 5, 8, 7, 7, 7, 8, 8, 8, 7, 8, 7, 8, 7, 8, 7, 8, 8, 7, 8, 7, 8, 3, 8, 7, 8, 3, 8],
           'accuracy': 0.4864000082015991, 'memory': 418129},
          {'quant_conf': [8, 4, 5, 6, 8, 8, 7, 6, 8, 5, 8, 8, 5, 8, 6, 6, 5, 5, 8, 4, 6, 6, 6, 4, 8, 8, 6, 4],
           'accuracy': 0.4875999987125397, 'memory': 373639},
          {'quant_conf': [8, 8, 7, 4, 6, 7, 8, 7, 4, 8, 6, 6, 7, 7, 7, 6, 6, 7, 7, 6, 6, 6, 7, 6, 8, 6, 7, 6],
           'accuracy': 0.48660001158714294, 'memory': 381994},
          {'quant_conf': [8, 7, 8, 7, 7, 8, 7, 8, 7, 7, 8, 8, 8, 8, 7, 8, 8, 8, 7, 8, 7, 7, 7, 7, 7, 7, 8, 8],
           'accuracy': 0.498199999332428, 'memory': 417190},
          {'quant_conf': [7, 3, 7, 7, 8, 4, 8, 3, 4, 8, 6, 8, 5, 8, 7, 8, 4, 4, 8, 4, 7, 2, 8, 4, 8, 8, 8, 7],
           'accuracy': 0.43160000443458557, 'memory': 292650},
          {'quant_conf': [7, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 7, 6, 6, 6, 6, 7, 7, 7, 6, 7, 6, 6, 8, 7, 7, 6],
           'accuracy': 0.4952000081539154, 'memory': 392742},
          {'quant_conf': [8, 8, 5, 7, 6, 8, 8, 4, 2, 4, 6, 8, 5, 8, 6, 6, 6, 5, 8, 6, 6, 2, 6, 8, 6, 4, 6, 8],
           'accuracy': 0.358599990606308, 'memory': 312172},
          {'quant_conf': [7, 4, 5, 7, 7, 7, 7, 7, 8, 5, 8, 7, 7, 8, 6, 7, 7, 7, 8, 4, 7, 7, 6, 7, 8, 7, 7, 4],
           'accuracy': 0.48739999532699585, 'memory': 395463},
          {'quant_conf': [3, 7, 7, 7, 6, 4, 3, 3, 4, 8, 7, 8, 8, 7, 7, 5, 4, 4, 8, 4, 7, 2, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.29179999232292175, 'memory': 285089},
          {'quant_conf': [7, 4, 5, 6, 8, 3, 7, 6, 3, 4, 8, 8, 6, 6, 5, 6, 8, 4, 8, 4, 7, 8, 8, 4, 6, 2, 7, 4],
           'accuracy': 0.4487999975681305, 'memory': 363870},
          {'quant_conf': [7, 5, 3, 7, 6, 7, 7, 7, 6, 7, 8, 7, 6, 6, 6, 7, 4, 7, 7, 7, 7, 3, 6, 6, 7, 7, 7, 6],
           'accuracy': 0.4189999997615814, 'memory': 341325},
          {'quant_conf': [8, 4, 7, 7, 7, 8, 7, 7, 8, 7, 8, 8, 5, 8, 6, 7, 5, 5, 7, 4, 6, 2, 7, 4, 8, 6, 7, 7],
           'accuracy': 0.4503999948501587, 'memory': 342775},
          {'quant_conf': [7, 8, 8, 8, 6, 3, 8, 7, 3, 4, 8, 2, 6, 8, 8, 8, 6, 8, 7, 4, 7, 3, 8, 8, 6, 8, 7, 8],
           'accuracy': 0.4153999984264374, 'memory': 328113},
          {'quant_conf': [8, 4, 5, 4, 8, 4, 7, 2, 3, 4, 7, 4, 6, 7, 5, 4, 5, 4, 7, 4, 2, 2, 8, 6, 6, 7, 2, 8],
           'accuracy': 0.33719998598098755, 'memory': 257836},
          {'quant_conf': [7, 7, 7, 7, 8, 3, 7, 4, 2, 4, 6, 8, 6, 8, 5, 5, 6, 4, 8, 4, 2, 3, 8, 6, 6, 2, 7, 6],
           'accuracy': 0.4000000059604645, 'memory': 304209},
          {'quant_conf': [8, 7, 7, 4, 8, 7, 7, 7, 4, 7, 7, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 4, 7, 7, 7, 7],
           'accuracy': 0.4903999865055084, 'memory': 392938},
          {'quant_conf': [7, 8, 8, 8, 8, 7, 7, 7, 8, 7, 8, 7, 8, 6, 6, 8, 8, 8, 7, 8, 8, 7, 8, 6, 6, 8, 7, 6],
           'accuracy': 0.48919999599456787, 'memory': 392598},
          {'quant_conf': [8, 8, 5, 7, 6, 7, 7, 7, 8, 5, 7, 8, 5, 7, 6, 7, 7, 7, 7, 7, 6, 6, 8, 7, 6, 6, 6, 7],
           'accuracy': 0.49219998717308044, 'memory': 380737},
          {'quant_conf': [7, 5, 7, 7, 7, 7, 7, 7, 3, 7, 8, 7, 6, 7, 3, 7, 4, 7, 7, 7, 7, 3, 6, 6, 6, 3, 3, 5],
           'accuracy': 0.4424000084400177, 'memory': 340479},
          {'quant_conf': [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 4, 6, 8, 8, 8, 8, 8, 8, 4],
           'accuracy': 0.4846000075340271, 'memory': 435904},
          {'quant_conf': [8, 8, 8, 6, 6, 8, 8, 6, 8, 5, 8, 8, 5, 8, 6, 8, 8, 8, 8, 8, 6, 8, 8, 8, 8, 6, 8, 8],
           'accuracy': 0.4970000088214874, 'memory': 412603},
          {'quant_conf': [8, 4, 7, 7, 6, 7, 7, 7, 8, 8, 2, 2, 8, 6, 5, 4, 6, 4, 7, 4, 6, 7, 6, 6, 8, 7, 7, 6],
           'accuracy': 0.41519999504089355, 'memory': 370861},
          {'quant_conf': [7, 4, 5, 6, 8, 8, 7, 7, 8, 5, 8, 8, 7, 8, 6, 7, 5, 5, 8, 4, 6, 6, 6, 4, 8, 8, 7, 4],
           'accuracy': 0.4828000068664551, 'memory': 384048},
          {'quant_conf': [7, 7, 7, 7, 7, 8, 7, 8, 7, 7, 8, 8, 5, 7, 6, 6, 7, 5, 7, 8, 6, 8, 8, 6, 7, 8, 7, 8],
           'accuracy': 0.4934000074863434, 'memory': 418755},
          {'quant_conf': [8, 5, 7, 4, 6, 3, 7, 7, 3, 8, 7, 4, 6, 6, 5, 7, 7, 7, 7, 4, 7, 3, 8, 4, 6, 8, 7, 4],
           'accuracy': 0.4081999957561493, 'memory': 311971},
          {'quant_conf': [8, 8, 8, 4, 7, 8, 7, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 5, 8, 8, 6, 8, 6, 4, 8, 6, 8, 4],
           'accuracy': 0.47940000891685486, 'memory': 424186},
          {'quant_conf': [7, 7, 7, 7, 8, 3, 3, 3, 7, 7, 7, 7, 8, 7, 7, 4, 4, 4, 8, 7, 8, 7, 7, 4, 7, 4, 7, 7],
           'accuracy': 0.46959999203681946, 'memory': 336789},
          {'quant_conf': [8, 7, 5, 4, 7, 8, 8, 7, 8, 7, 8, 8, 7, 8, 7, 7, 5, 5, 8, 4, 6, 2, 6, 7, 7, 7, 7, 4],
           'accuracy': 0.3984000086784363, 'memory': 348373},
          {'quant_conf': [8, 7, 7, 6, 6, 4, 7, 6, 2, 4, 6, 8, 5, 8, 7, 5, 5, 4, 8, 4, 2, 2, 6, 4, 8, 4, 2, 4],
           'accuracy': 0.3140000104904175, 'memory': 317530},
          {'quant_conf': [7, 7, 7, 4, 7, 7, 7, 7, 8, 5, 8, 7, 7, 8, 6, 7, 7, 8, 8, 7, 6, 7, 7, 7, 8, 7, 6, 4],
           'accuracy': 0.483599990606308, 'memory': 402726},
          {'quant_conf': [8, 4, 4, 8, 7, 8, 7, 8, 8, 5, 8, 7, 5, 8, 6, 6, 5, 7, 7, 8, 6, 3, 3, 3, 8, 6, 6, 5],
           'accuracy': 0.4514000117778778, 'memory': 358132},
          {'quant_conf': [7, 4, 7, 8, 7, 3, 7, 7, 8, 4, 8, 8, 6, 6, 5, 4, 6, 5, 7, 4, 7, 3, 8, 6, 6, 2, 7, 6],
           'accuracy': 0.44440001249313354, 'memory': 327375},
          {'quant_conf': [3, 3, 3, 3, 8, 8, 7, 6, 8, 8, 7, 8, 5, 8, 3, 4, 4, 5, 8, 4, 7, 3, 7, 4, 8, 8, 6, 4],
           'accuracy': 0.4352000057697296, 'memory': 336461},
          {'quant_conf': [7, 4, 7, 8, 7, 3, 7, 8, 3, 4, 2, 2, 7, 6, 6, 4, 6, 4, 7, 4, 7, 3, 6, 6, 8, 2, 7, 6],
           'accuracy': 0.41200000047683716, 'memory': 330357},
          {'quant_conf': [7, 4, 7, 7, 7, 7, 7, 7, 8, 5, 8, 8, 7, 8, 6, 7, 6, 7, 7, 4, 7, 7, 6, 6, 8, 7, 7, 6],
           'accuracy': 0.4909999966621399, 'memory': 395976},
          {'quant_conf': [8, 8, 8, 6, 8, 8, 6, 8, 8, 8, 8, 8, 5, 8, 8, 6, 8, 5, 8, 6, 6, 6, 8, 8, 8, 6, 6, 8],
           'accuracy': 0.49219998717308044, 'memory': 416107},
          {'quant_conf': [7, 5, 7, 7, 7, 7, 7, 7, 7, 7, 8, 7, 4, 7, 3, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3, 7, 7],
           'accuracy': 0.48399999737739563, 'memory': 391191},
          {'quant_conf': [8, 4, 8, 4, 8, 4, 7, 8, 8, 8, 8, 8, 7, 7, 7, 4, 5, 4, 8, 8, 2, 8, 8, 8, 8, 8, 2, 4],
           'accuracy': 0.45260000228881836, 'memory': 416116},
          {'quant_conf': [8, 4, 5, 4, 8, 7, 7, 7, 8, 4, 7, 7, 7, 8, 6, 8, 5, 4, 8, 4, 7, 7, 6, 7, 8, 7, 7, 4],
           'accuracy': 0.48100000619888306, 'memory': 397582},
          {'quant_conf': [7, 4, 7, 4, 7, 8, 7, 6, 8, 5, 8, 8, 5, 8, 6, 6, 6, 5, 7, 8, 6, 2, 6, 4, 8, 6, 6, 4],
           'accuracy': 0.46639999747276306, 'memory': 333456},
          {'quant_conf': [7, 4, 5, 8, 7, 7, 7, 7, 8, 7, 8, 7, 7, 7, 3, 7, 4, 7, 8, 8, 7, 3, 3, 3, 8, 7, 3, 5],
           'accuracy': 0.3783999979496002, 'memory': 342819},
          {'quant_conf': [8, 3, 7, 8, 6, 4, 7, 3, 4, 8, 7, 8, 8, 8, 7, 5, 4, 4, 8, 4, 8, 2, 8, 4, 8, 4, 2, 6],
           'accuracy': 0.36880001425743103, 'memory': 286966},
          {'quant_conf': [8, 4, 5, 4, 8, 4, 7, 7, 3, 4, 8, 4, 4, 7, 7, 7, 4, 7, 8, 4, 2, 2, 4, 4, 7, 3, 3, 5],
           'accuracy': 0.3131999969482422, 'memory': 310783},
          {'quant_conf': [8, 8, 5, 6, 6, 8, 6, 8, 8, 5, 8, 7, 5, 7, 6, 7, 7, 7, 8, 7, 6, 7, 6, 8, 7, 6, 6, 7],
           'accuracy': 0.5001999735832214, 'memory': 408451},
          {'quant_conf': [8, 8, 5, 7, 8, 7, 7, 6, 8, 5, 8, 8, 6, 8, 6, 7, 6, 6, 7, 4, 6, 6, 6, 4, 8, 8, 7, 8],
           'accuracy': 0.4740000069141388, 'memory': 377038},
          {'quant_conf': [8, 7, 5, 4, 8, 4, 7, 2, 2, 4, 6, 4, 7, 8, 7, 8, 5, 4, 8, 4, 2, 2, 8, 4, 8, 7, 2, 8],
           'accuracy': 0.27379998564720154, 'memory': 272431},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 8, 8, 7, 7, 6, 8, 5, 7, 8, 7, 6, 8, 7, 7, 7, 7, 6, 6, 7, 7, 7, 6],
           'accuracy': 0.4941999912261963, 'memory': 403776},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 8, 7, 7, 7, 6, 8, 6, 7, 8, 7, 7, 7, 7, 8, 7, 7, 6, 7, 6, 7, 7, 7],
           'accuracy': 0.4934000074863434, 'memory': 391725},
          {'quant_conf': [8, 8, 5, 8, 7, 8, 7, 6, 8, 8, 8, 8, 5, 8, 8, 8, 8, 8, 8, 4, 8, 8, 6, 4, 8, 6, 8, 4],
           'accuracy': 0.49380001425743103, 'memory': 401200},
          {'quant_conf': [3, 4, 3, 3, 8, 8, 7, 3, 4, 8, 8, 8, 5, 7, 3, 4, 5, 4, 8, 4, 7, 3, 7, 4, 8, 4, 6, 7],
           'accuracy': 0.3962000012397766, 'memory': 302651},
          {'quant_conf': [8, 4, 7, 7, 6, 8, 7, 7, 6, 7, 6, 8, 6, 6, 6, 6, 5, 5, 7, 7, 6, 7, 6, 8, 8, 6, 7, 4],
           'accuracy': 0.4909999966621399, 'memory': 397405},
          {'quant_conf': [7, 4, 5, 7, 8, 8, 7, 7, 8, 5, 8, 8, 7, 8, 6, 7, 5, 7, 8, 4, 6, 6, 6, 7, 8, 8, 7, 4],
           'accuracy': 0.48420000076293945, 'memory': 392445},
          {'quant_conf': [8, 4, 7, 7, 6, 7, 7, 7, 6, 7, 6, 8, 6, 6, 6, 6, 5, 7, 7, 7, 6, 7, 6, 8, 8, 7, 7, 4],
           'accuracy': 0.4878000020980835, 'memory': 395308},
          {'quant_conf': [3, 3, 3, 7, 6, 8, 3, 7, 4, 8, 6, 8, 6, 6, 6, 6, 5, 4, 8, 4, 8, 3, 7, 8, 8, 4, 7, 4],
           'accuracy': 0.39719998836517334, 'memory': 348311},
          {'quant_conf': [7, 7, 7, 7, 8, 4, 3, 3, 2, 8, 6, 8, 8, 7, 3, 5, 4, 4, 8, 4, 7, 3, 7, 4, 8, 4, 8, 6],
           'accuracy': 0.43619999289512634, 'memory': 300456},
          {'quant_conf': [8, 7, 5, 6, 6, 8, 7, 7, 8, 5, 8, 7, 5, 8, 8, 7, 7, 7, 8, 7, 7, 7, 6, 8, 7, 7, 7, 8],
           'accuracy': 0.4957999885082245, 'memory': 401020},
          {'quant_conf': [7, 7, 7, 7, 7, 7, 7, 7, 3, 7, 7, 7, 4, 7, 7, 7, 4, 7, 7, 8, 7, 3, 7, 3, 7, 7, 7, 7],
           'accuracy': 0.48500001430511475, 'memory': 343965},
          {'quant_conf': [7, 7, 7, 7, 6, 4, 7, 4, 6, 4, 6, 8, 6, 8, 6, 7, 6, 6, 7, 4, 2, 7, 8, 4, 6, 8, 2, 6],
           'accuracy': 0.257999986410141, 'memory': 339963},
          {'quant_conf': [8, 8, 5, 6, 7, 8, 7, 6, 8, 8, 8, 7, 5, 8, 8, 7, 8, 8, 8, 7, 8, 7, 6, 4, 7, 6, 8, 7],
           'accuracy': 0.49399998784065247, 'memory': 385447},
          {'quant_conf': [8, 7, 7, 8, 7, 8, 7, 6, 7, 7, 7, 8, 5, 7, 8, 7, 8, 8, 7, 7, 7, 7, 7, 4, 7, 6, 8, 7],
           'accuracy': 0.49399998784065247, 'memory': 384376},
          {'quant_conf': [8, 8, 7, 4, 6, 8, 7, 8, 8, 5, 8, 7, 5, 7, 6, 7, 7, 7, 8, 7, 6, 4, 6, 8, 7, 6, 7, 7],
           'accuracy': 0.4779999852180481, 'memory': 378616},
          {'quant_conf': [8, 8, 7, 6, 6, 8, 7, 7, 8, 5, 6, 8, 5, 6, 6, 6, 5, 5, 7, 7, 6, 7, 6, 8, 6, 6, 6, 8],
           'accuracy': 0.49160000681877136, 'memory': 392332},
          {'quant_conf': [8, 8, 5, 4, 8, 8, 7, 2, 8, 8, 8, 4, 8, 8, 7, 8, 8, 8, 8, 4, 8, 2, 8, 8, 8, 8, 2, 8],
           'accuracy': 0.4472000002861023, 'memory': 301354},
          {'quant_conf': [8, 8, 8, 8, 7, 8, 7, 7, 3, 5, 8, 8, 4, 7, 3, 7, 4, 7, 8, 8, 7, 3, 6, 3, 6, 3, 6, 8],
           'accuracy': 0.46160000562667847, 'memory': 344038},
          {'quant_conf': [7, 4, 7, 4, 7, 7, 7, 7, 7, 8, 7, 4, 7, 7, 6, 7, 6, 7, 7, 7, 7, 4, 7, 6, 8, 4, 7, 7],
           'accuracy': 0.47679999470710754, 'memory': 355428},
          {'quant_conf': [8, 7, 7, 7, 7, 4, 7, 7, 2, 4, 6, 8, 7, 7, 7, 5, 6, 7, 8, 7, 7, 2, 7, 4, 8, 4, 2, 7],
           'accuracy': 0.3970000147819519, 'memory': 334756},
          {'quant_conf': [8, 4, 7, 7, 7, 8, 7, 6, 8, 5, 8, 7, 5, 7, 6, 7, 6, 7, 8, 7, 6, 7, 6, 8, 8, 7, 6, 7],
           'accuracy': 0.4934000074863434, 'memory': 391462},
          {'quant_conf': [8, 4, 5, 4, 7, 8, 7, 6, 8, 4, 8, 8, 5, 8, 6, 6, 6, 4, 8, 4, 6, 2, 6, 8, 8, 6, 6, 6],
           'accuracy': 0.46160000562667847, 'memory': 340066},
          {'quant_conf': [7, 7, 8, 8, 6, 4, 7, 4, 2, 4, 8, 8, 8, 8, 8, 5, 8, 4, 8, 8, 2, 8, 8, 8, 8, 4, 2, 8],
           'accuracy': 0.4490000009536743, 'memory': 374397},
          {'quant_conf': [8, 8, 5, 7, 6, 8, 6, 7, 8, 7, 8, 7, 4, 7, 6, 8, 4, 7, 8, 7, 6, 3, 3, 8, 7, 8, 6, 7],
           'accuracy': 0.43779999017715454, 'memory': 356635},
          {'quant_conf': [8, 8, 7, 4, 6, 7, 7, 7, 6, 8, 7, 8, 7, 6, 7, 8, 6, 6, 7, 7, 7, 4, 7, 6, 8, 7, 7, 7],
           'accuracy': 0.48420000076293945, 'memory': 366910},
          {'quant_conf': [7, 5, 5, 8, 8, 3, 6, 6, 8, 4, 8, 2, 6, 8, 5, 6, 6, 5, 7, 6, 7, 3, 6, 8, 6, 2, 6, 8],
           'accuracy': 0.38440001010894775, 'memory': 316590},
          {'quant_conf': [8, 5, 7, 7, 6, 7, 7, 7, 6, 4, 6, 2, 6, 6, 5, 7, 6, 6, 7, 4, 7, 7, 8, 6, 6, 7, 7, 4],
           'accuracy': 0.46639999747276306, 'memory': 363202},
          {'quant_conf': [3, 8, 5, 3, 7, 8, 3, 6, 4, 8, 7, 8, 8, 7, 8, 8, 8, 8, 8, 4, 7, 3, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.3452000021934509, 'memory': 342455},
          {'quant_conf': [8, 8, 7, 7, 6, 7, 7, 7, 4, 8, 7, 7, 7, 6, 6, 7, 7, 6, 7, 7, 7, 4, 7, 6, 6, 7, 7, 7],
           'accuracy': 0.46560001373291016, 'memory': 352927},
          {'quant_conf': [8, 8, 5, 4, 6, 4, 7, 2, 8, 5, 8, 4, 5, 7, 6, 4, 8, 7, 8, 7, 2, 2, 6, 8, 7, 6, 2, 4],
           'accuracy': 0.4131999909877777, 'memory': 273184},
          {'quant_conf': [8, 4, 5, 4, 6, 4, 7, 8, 2, 5, 8, 8, 5, 8, 6, 6, 5, 5, 8, 4, 2, 6, 6, 4, 6, 7, 2, 8],
           'accuracy': 0.4474000036716461, 'memory': 364675},
          {'quant_conf': [7, 7, 3, 3, 8, 3, 3, 3, 4, 4, 6, 8, 8, 7, 3, 4, 4, 4, 8, 4, 7, 3, 8, 4, 8, 4, 8, 6],
           'accuracy': 0.4244000017642975, 'memory': 295143},
          {'quant_conf': [8, 4, 3, 3, 6, 8, 3, 3, 6, 7, 6, 8, 8, 7, 6, 6, 4, 4, 8, 7, 6, 8, 6, 4, 8, 8, 8, 4],
           'accuracy': 0.4625999927520752, 'memory': 355747},
          {'quant_conf': [8, 3, 3, 6, 6, 8, 3, 3, 8, 5, 8, 8, 8, 7, 8, 4, 7, 4, 8, 7, 6, 3, 7, 4, 8, 4, 8, 7],
           'accuracy': 0.4390000104904175, 'memory': 304900},
          {'quant_conf': [8, 4, 5, 4, 8, 8, 7, 2, 8, 5, 8, 4, 7, 7, 6, 4, 5, 4, 8, 4, 2, 2, 4, 4, 8, 6, 6, 4],
           'accuracy': 0.27799999713897705, 'memory': 274069},
          {'quant_conf': [8, 4, 7, 7, 7, 7, 7, 7, 6, 7, 6, 7, 6, 6, 6, 7, 7, 7, 7, 7, 6, 7, 6, 7, 7, 7, 7, 4],
           'accuracy': 0.4927999973297119, 'memory': 388180},
          {'quant_conf': [7, 8, 8, 8, 7, 7, 7, 6, 8, 7, 7, 8, 5, 8, 6, 8, 6, 8, 7, 8, 6, 8, 6, 6, 8, 7, 8, 6],
           'accuracy': 0.4934000074863434, 'memory': 405687},
          {'quant_conf': [8, 4, 7, 8, 6, 8, 7, 7, 6, 7, 8, 8, 6, 6, 6, 6, 6, 5, 7, 8, 6, 7, 6, 8, 8, 7, 7, 4],
           'accuracy': 0.4925999939441681, 'memory': 398665},
          {'quant_conf': [8, 8, 7, 6, 6, 8, 7, 6, 3, 4, 2, 8, 5, 6, 5, 6, 6, 5, 7, 6, 6, 3, 6, 6, 6, 2, 7, 8],
           'accuracy': 0.42320001125335693, 'memory': 332671},
          {'quant_conf': [8, 4, 5, 4, 7, 8, 7, 2, 8, 4, 8, 8, 5, 7, 7, 8, 5, 5, 8, 4, 2, 2, 6, 4, 8, 6, 6, 4],
           'accuracy': 0.35519999265670776, 'memory': 284941},
          {'quant_conf': [7, 8, 8, 8, 8, 8, 8, 8, 6, 8, 6, 7, 8, 8, 8, 7, 8, 8, 7, 8, 7, 8, 8, 8, 8, 7, 8, 6],
           'accuracy': 0.4880000054836273, 'memory': 436281},
          {'quant_conf': [8, 8, 7, 8, 8, 8, 7, 8, 8, 8, 8, 8, 8, 8, 7, 5, 6, 8, 8, 8, 8, 2, 8, 8, 8, 4, 8, 8],
           'accuracy': 0.4611999988555908, 'memory': 377701},
          {'quant_conf': [7, 7, 7, 7, 6, 4, 7, 7, 2, 7, 6, 8, 5, 8, 8, 7, 6, 4, 8, 4, 8, 8, 8, 6, 6, 4, 7, 6],
           'accuracy': 0.47380000352859497, 'memory': 389580},
          {'quant_conf': [8, 4, 5, 8, 6, 8, 7, 7, 6, 7, 8, 8, 5, 7, 6, 7, 6, 7, 7, 8, 6, 7, 6, 8, 8, 7, 6, 4],
           'accuracy': 0.492000013589859, 'memory': 401158},
          {'quant_conf': [7, 8, 7, 7, 8, 4, 6, 4, 2, 4, 6, 8, 5, 8, 6, 6, 6, 5, 8, 4, 6, 2, 8, 8, 8, 4, 2, 8],
           'accuracy': 0.40639999508857727, 'memory': 316425},
          {'quant_conf': [8, 8, 7, 7, 7, 7, 7, 6, 7, 5, 8, 8, 7, 8, 6, 6, 5, 7, 7, 6, 6, 6, 6, 6, 8, 6, 6, 8],
           'accuracy': 0.4912000000476837, 'memory': 381688},
          {'quant_conf': [8, 8, 7, 8, 6, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 7, 6, 6, 8, 7, 7, 8, 6, 8, 8, 7, 7, 8],
           'accuracy': 0.49160000681877136, 'memory': 429829},
          {'quant_conf': [8, 4, 3, 3, 8, 7, 7, 7, 6, 8, 6, 8, 6, 7, 3, 8, 4, 7, 8, 7, 7, 3, 7, 4, 8, 4, 7, 4],
           'accuracy': 0.4284000098705292, 'memory': 350368},
          {'quant_conf': [3, 8, 3, 3, 8, 8, 8, 3, 4, 8, 7, 8, 8, 7, 3, 8, 8, 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 7],
           'accuracy': 0.358599990606308, 'memory': 366518},
          {'quant_conf': [7, 4, 3, 8, 7, 7, 7, 7, 3, 8, 8, 8, 4, 6, 6, 7, 4, 7, 7, 7, 6, 7, 6, 3, 8, 3, 3, 5],
           'accuracy': 0.44839999079704285, 'memory': 381912},
          {'quant_conf': [7, 5, 5, 6, 6, 3, 7, 6, 8, 5, 8, 2, 5, 8, 6, 6, 6, 5, 7, 6, 6, 6, 8, 6, 6, 2, 6, 4],
           'accuracy': 0.41620001196861267, 'memory': 337353},
          {'quant_conf': [8, 7, 5, 8, 6, 8, 7, 6, 2, 8, 8, 8, 5, 8, 7, 5, 6, 4, 8, 4, 2, 2, 8, 4, 8, 4, 8, 4],
           'accuracy': 0.42480000853538513, 'memory': 329428},
          {'quant_conf': [8, 8, 7, 7, 7, 7, 7, 6, 7, 5, 7, 8, 7, 6, 6, 6, 8, 5, 8, 4, 6, 7, 6, 4, 8, 7, 8, 6],
           'accuracy': 0.4878000020980835, 'memory': 379909},
          {'quant_conf': [8, 8, 5, 8, 7, 8, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, 8, 8, 8, 8, 8, 6, 8, 4],
           'accuracy': 0.48980000615119934, 'memory': 433546},
          {'quant_conf': [7, 8, 7, 7, 8, 8, 7, 2, 2, 5, 7, 4, 7, 7, 7, 4, 5, 5, 7, 4, 2, 8, 4, 6, 8, 7, 2, 8],
           'accuracy': 0.35920000076293945, 'memory': 344973},
          {'quant_conf': [8, 8, 5, 7, 6, 8, 6, 7, 3, 7, 8, 7, 5, 8, 8, 7, 2, 7, 7, 8, 7, 6, 3, 8, 6, 6, 3, 8],
           'accuracy': 0.444599986076355, 'memory': 384259},
          {'quant_conf': [8, 3, 7, 7, 8, 3, 3, 8, 4, 7, 6, 8, 8, 8, 8, 7, 4, 4, 8, 4, 8, 3, 7, 4, 8, 4, 8, 4],
           'accuracy': 0.43720000982284546, 'memory': 351886},
          {'quant_conf': [7, 5, 7, 8, 6, 8, 7, 7, 6, 7, 2, 8, 6, 6, 6, 6, 6, 5, 7, 4, 6, 7, 8, 8, 8, 7, 7, 4],
           'accuracy': 0.47040000557899475, 'memory': 396453},
          {'quant_conf': [8, 4, 7, 8, 7, 8, 7, 7, 6, 7, 8, 8, 8, 7, 3, 6, 4, 7, 7, 8, 6, 3, 6, 3, 8, 7, 7, 5],
           'accuracy': 0.42579999566078186, 'memory': 349144},
          {'quant_conf': [8, 8, 5, 6, 7, 7, 6, 6, 8, 7, 6, 7, 8, 8, 6, 7, 7, 7, 8, 6, 6, 6, 6, 8, 6, 6, 6, 4],
           'accuracy': 0.48820000886917114, 'memory': 374311},
          {'quant_conf': [8, 5, 3, 4, 7, 7, 8, 7, 2, 4, 7, 7, 4, 7, 3, 7, 4, 4, 7, 8, 2, 2, 3, 4, 8, 7, 2, 5],
           'accuracy': 0.27059999108314514, 'memory': 329569},
          {'quant_conf': [8, 4, 8, 8, 8, 8, 7, 7, 8, 8, 8, 8, 8, 6, 6, 6, 8, 5, 8, 8, 6, 8, 8, 8, 8, 7, 8, 8],
           'accuracy': 0.49939998984336853, 'memory': 417439},
          {'quant_conf': [7, 7, 7, 7, 6, 7, 7, 7, 7, 7, 6, 7, 6, 7, 7, 7, 6, 7, 7, 7, 7, 7, 7, 7, 6, 7, 7, 6],
           'accuracy': 0.4941999912261963, 'memory': 387909},
          {'quant_conf': [7, 8, 8, 8, 8, 3, 8, 7, 3, 8, 2, 2, 6, 6, 5, 4, 8, 4, 8, 4, 8, 3, 8, 6, 6, 8, 7, 8],
           'accuracy': 0.42399999499320984, 'memory': 320724},
          {'quant_conf': [8, 4, 7, 7, 8, 4, 7, 2, 2, 4, 7, 8, 5, 7, 7, 5, 6, 8, 8, 4, 2, 2, 8, 4, 8, 7, 8, 6],
           'accuracy': 0.39719998836517334, 'memory': 277264},
          {'quant_conf': [7, 4, 7, 7, 6, 8, 8, 6, 8, 5, 2, 2, 6, 6, 5, 6, 6, 5, 8, 8, 6, 7, 8, 6, 6, 7, 7, 6],
           'accuracy': 0.436599999666214, 'memory': 357510},
          {'quant_conf': [7, 8, 8, 8, 6, 8, 7, 8, 8, 5, 2, 2, 6, 6, 8, 4, 6, 5, 8, 8, 8, 3, 8, 6, 6, 7, 7, 6],
           'accuracy': 0.4189999997615814, 'memory': 344490},
          {'quant_conf': [8, 7, 8, 7, 7, 4, 7, 6, 2, 5, 6, 8, 5, 8, 7, 6, 6, 5, 8, 4, 2, 2, 6, 4, 8, 8, 6, 4],
           'accuracy': 0.42320001125335693, 'memory': 322075},
          {'quant_conf': [7, 7, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 5, 8, 6, 6, 7, 7, 8, 6, 7, 6, 7, 7, 6, 6, 6, 8],
           'accuracy': 0.4952000081539154, 'memory': 384354},
          {'quant_conf': [3, 3, 3, 3, 8, 3, 7, 8, 4, 7, 7, 8, 8, 7, 6, 6, 4, 7, 7, 4, 6, 7, 7, 6, 8, 7, 7, 7],
           'accuracy': 0.4050000011920929, 'memory': 388499},
          {'quant_conf': [7, 8, 7, 7, 7, 8, 7, 7, 7, 7, 7, 8, 7, 6, 6, 6, 6, 5, 7, 7, 6, 7, 6, 6, 8, 7, 7, 4],
           'accuracy': 0.4830000102519989, 'memory': 399831},
          {'quant_conf': [3, 8, 3, 3, 8, 3, 8, 3, 8, 8, 6, 8, 5, 7, 3, 5, 4, 4, 8, 4, 7, 2, 8, 4, 8, 4, 8, 6],
           'accuracy': 0.334199994802475, 'memory': 286601},
          {'quant_conf': [7, 7, 7, 7, 7, 7, 7, 7, 3, 7, 6, 7, 4, 6, 3, 7, 4, 6, 7, 8, 7, 3, 3, 6, 7, 3, 3, 5],
           'accuracy': 0.4528000056743622, 'memory': 344766},
          {'quant_conf': [8, 4, 5, 7, 7, 8, 7, 6, 8, 5, 8, 8, 6, 6, 6, 6, 5, 5, 7, 8, 6, 2, 6, 6, 8, 7, 6, 6],
           'accuracy': 0.4275999963283539, 'memory': 333775},
          {'quant_conf': [8, 8, 5, 8, 8, 8, 7, 2, 2, 4, 8, 8, 7, 8, 8, 8, 5, 8, 8, 4, 8, 2, 6, 4, 7, 6, 8, 4],
           'accuracy': 0.4291999936103821, 'memory': 292903},
          {'quant_conf': [8, 4, 7, 7, 7, 8, 7, 8, 8, 7, 8, 7, 5, 7, 6, 7, 7, 7, 7, 7, 6, 7, 6, 7, 7, 6, 7, 4],
           'accuracy': 0.4893999993801117, 'memory': 404296},
          {'quant_conf': [3, 4, 7, 3, 8, 7, 3, 3, 7, 8, 7, 8, 7, 6, 3, 4, 4, 4, 7, 8, 8, 7, 7, 6, 8, 4, 8, 7],
           'accuracy': 0.4004000127315521, 'memory': 349499},
          {'quant_conf': [7, 5, 7, 8, 7, 8, 7, 6, 3, 4, 2, 8, 6, 6, 5, 6, 6, 4, 7, 8, 6, 3, 6, 6, 8, 2, 7, 6],
           'accuracy': 0.44339999556541443, 'memory': 343035},
          {'quant_conf': [8, 8, 5, 6, 7, 8, 7, 8, 8, 5, 8, 8, 7, 6, 6, 6, 7, 7, 8, 7, 6, 7, 6, 6, 8, 7, 8, 7],
           'accuracy': 0.49300000071525574, 'memory': 410953},
          {'quant_conf': [8, 4, 5, 7, 7, 8, 7, 6, 8, 5, 6, 7, 6, 6, 6, 7, 5, 5, 8, 8, 6, 2, 6, 4, 8, 6, 6, 4],
           'accuracy': 0.46380001306533813, 'memory': 326638},
          {'quant_conf': [8, 7, 8, 8, 7, 7, 8, 7, 7, 7, 8, 7, 8, 8, 7, 7, 5, 7, 8, 6, 7, 7, 7, 7, 8, 6, 7, 7],
           'accuracy': 0.4975999891757965, 'memory': 404491},
          {'quant_conf': [7, 7, 7, 8, 6, 7, 7, 4, 2, 7, 6, 7, 5, 6, 6, 7, 6, 8, 8, 7, 2, 2, 6, 4, 8, 7, 7, 6],
           'accuracy': 0.35499998927116394, 'memory': 301740},
          {'quant_conf': [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3, 7, 7, 7, 7, 8, 7, 4, 3, 7, 7, 3, 3, 5],
           'accuracy': 0.44519999623298645, 'memory': 362151},
          {'quant_conf': [8, 4, 7, 6, 6, 7, 6, 7, 8, 7, 7, 8, 7, 8, 8, 6, 8, 7, 7, 8, 6, 6, 6, 8, 8, 7, 6, 6],
           'accuracy': 0.4896000027656555, 'memory': 393043},
          {'quant_conf': [8, 4, 5, 6, 6, 8, 7, 8, 8, 5, 8, 8, 5, 8, 8, 6, 7, 7, 8, 7, 6, 2, 6, 8, 8, 6, 6, 7],
           'accuracy': 0.47920000553131104, 'memory': 363322},
          {'quant_conf': [8, 8, 7, 7, 7, 7, 7, 7, 6, 7, 6, 7, 6, 7, 6, 7, 7, 7, 7, 7, 6, 7, 7, 7, 7, 7, 7, 4],
           'accuracy': 0.4968000054359436, 'memory': 396340},
          {'quant_conf': [8, 8, 8, 7, 6, 8, 6, 7, 6, 5, 8, 8, 6, 8, 6, 7, 7, 5, 7, 7, 6, 6, 6, 7, 6, 6, 6, 8],
           'accuracy': 0.49059998989105225, 'memory': 385411},
          {'quant_conf': [8, 4, 7, 7, 6, 7, 7, 7, 6, 7, 6, 7, 6, 6, 6, 7, 7, 6, 7, 7, 7, 7, 6, 7, 7, 7, 7, 6],
           'accuracy': 0.4968000054359436, 'memory': 385975},
          {'quant_conf': [8, 4, 5, 7, 7, 7, 7, 2, 2, 7, 7, 4, 4, 7, 3, 7, 4, 4, 7, 4, 2, 3, 4, 3, 8, 3, 2, 5],
           'accuracy': 0.40779998898506165, 'memory': 274558},
          {'quant_conf': [7, 7, 7, 8, 6, 3, 7, 7, 7, 4, 7, 2, 6, 7, 8, 7, 7, 7, 7, 7, 7, 3, 8, 6, 6, 7, 7, 7],
           'accuracy': 0.3937999904155731, 'memory': 321693},
          {'quant_conf': [3, 3, 5, 6, 8, 8, 8, 8, 4, 8, 8, 8, 8, 7, 6, 7, 8, 7, 8, 4, 6, 7, 8, 8, 7, 6, 8, 7],
           'accuracy': 0.4318000078201294, 'memory': 404987},
          {'quant_conf': [7, 5, 7, 7, 6, 3, 7, 7, 3, 8, 2, 2, 6, 6, 5, 4, 6, 4, 7, 4, 7, 8, 6, 6, 6, 2, 7, 4],
           'accuracy': 0.41260001063346863, 'memory': 359286},
          {'quant_conf': [8, 4, 7, 6, 6, 8, 6, 6, 8, 5, 8, 8, 5, 6, 6, 6, 5, 8, 8, 6, 6, 6, 6, 6, 8, 7, 6, 6],
           'accuracy': 0.48579999804496765, 'memory': 371866},
          {'quant_conf': [7, 5, 7, 6, 6, 8, 6, 7, 8, 4, 8, 7, 6, 7, 5, 4, 6, 7, 7, 7, 8, 7, 8, 8, 7, 2, 6, 7],
           'accuracy': 0.45899999141693115, 'memory': 393579},
          {'quant_conf': [8, 4, 8, 7, 7, 8, 7, 7, 3, 7, 8, 7, 6, 7, 6, 7, 7, 7, 7, 8, 6, 3, 6, 3, 7, 3, 7, 5],
           'accuracy': 0.41760000586509705, 'memory': 342556},
          {'quant_conf': [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 7, 4, 7, 7, 7, 7, 7, 7, 8, 7, 8, 3, 3, 7, 3, 3, 7],
           'accuracy': 0.4519999921321869, 'memory': 394347},
          {'quant_conf': [7, 5, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 4, 7, 7, 7, 7, 7, 7, 8, 7, 3, 3, 7, 7, 3, 3, 7],
           'accuracy': 0.4004000127315521, 'memory': 349806},
          {'quant_conf': [7, 8, 5, 7, 7, 8, 7, 8, 8, 5, 8, 7, 5, 8, 8, 8, 6, 7, 8, 8, 6, 7, 6, 8, 7, 7, 7, 7],
           'accuracy': 0.4903999865055084, 'memory': 415548},
          {'quant_conf': [7, 7, 8, 8, 8, 8, 7, 8, 6, 8, 8, 7, 8, 6, 8, 8, 8, 6, 8, 8, 8, 7, 8, 6, 8, 8, 8, 6],
           'accuracy': 0.4941999912261963, 'memory': 415311},
          {'quant_conf': [7, 5, 5, 4, 7, 8, 7, 7, 3, 7, 8, 8, 4, 8, 3, 7, 5, 8, 7, 4, 7, 3, 3, 4, 8, 3, 6, 4],
           'accuracy': 0.4458000063896179, 'memory': 348192},
          {'quant_conf': [7, 7, 7, 8, 6, 4, 7, 7, 2, 4, 6, 2, 5, 6, 5, 8, 6, 4, 8, 4, 7, 3, 8, 6, 8, 2, 7, 6],
           'accuracy': 0.4153999984264374, 'memory': 326160},
          {'quant_conf': [8, 4, 7, 7, 7, 7, 7, 7, 6, 7, 6, 7, 6, 6, 6, 7, 6, 7, 7, 7, 6, 7, 6, 6, 6, 7, 7, 4],
           'accuracy': 0.498199999332428, 'memory': 380269}]


def _get_quantizable_layers_mask():
    transformer = PerLayerQuantizeModelTransformer(base_model, [], {})

    groups = transformer.get_quantizable_layers_groups()
    mask = [0 for _ in range(len(groups))]
    count = 1
    for i, group in enumerate(groups):
        if calculate_model_size.calculate_weights_mobilenet_size(base_model, only_layers=group) > 0:
            mask[i] = count
            count = count + 1

    print(groups)
    print(mask)

    return mask


mask = _get_quantizable_layers_mask()


def get_quantizable_layers():
    return len(list(filter(lambda x: x != 0, mask)))


queue = Queue()

logical_devices = tf.config.list_logical_devices()
print(logical_devices)
for device in logical_devices:
    queue.put(device)

pool = ThreadPoolExecutor(max_workers=len(logical_devices))


def get_memory_eval(conf):
    device = queue.get()
    try:
        match = list(filter(lambda x: x["quant_conf"] == conf, cached))

        if len(match) > 0:
            return match[0]["memory"]

        with tf.device(device):
            base_model_2 = keras.models.load_model("mobilenet_tinyimagenet.keras")

            def quantize_model_by_config(quant_config):
                quant_config = quant_config.copy()
                quant_config.append(8)  # Insert last value a default one, because 0 - 1 = -1 will be default

                final_quant_config = [quant_config[i - 1] for i in mask]
                print("Final quant config")
                print(final_quant_config)
                config = [{"weight_bits": final_quant_config[i], "activation_bits": 8} for i in range(len(mask))]
                return quantize_model(base_model_2, config)

            return calculate_model_size.calculate_weights_mobilenet_size(quantize_model_by_config(conf))
    finally:
        queue.put(device)


for fn in glob.glob("cache/%s_%d_%d_*.json.gz" % ("mobilenet", 256, 6)):
    print("cache open", fn)

    act = json.load(gzip.open(fn))

    total = len(act)
    memory_results = pool.map(get_memory_eval, [c["quant_conf"] for c in act])

    for i, memory_result in enumerate(memory_results):
        act[i]["memory"] = int(memory_result)
        print(f"Done {i + 1}/{total}")

    print(act)
    json.dump(act, gzip.open(fn, "wt", encoding="utf8"))
